<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="ggchangepoint">
<title>Introduction to ggchangepoint • ggchangepoint</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to ggchangepoint">
<meta property="og:description" content="ggchangepoint">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-default navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">ggchangepoint</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-vignettes">Vignettes</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-vignettes">
    <a class="dropdown-item" href="../articles/introduction.html">Introduction to ggchangepoint</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">News</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/PursuitOfDataScience/ggchangepoint">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">



<script src="introduction_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <main id="main"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Introduction to ggchangepoint</h1>
                        <h4 data-toc-skip class="author">Youzhi Yu</h4>
            
            <h4 data-toc-skip class="date">2022-02-24</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/PursuitOfDataScience/ggchangepoint/blob/HEAD/vignettes/introduction.Rmd" class="external-link"><code>vignettes/introduction.Rmd</code></a></small>
      <div class="d-none name"><code>introduction.Rmd</code></div>
    </div>

    
    
<p>There are a number of changepoint detection packages in R. These packages have various APIs and sometimes it is difficult to compare the changepoints detected by various packages on the same data. Moreover, visualizing these changepoints along with the raw data is not connected to ggplot2. What the ggchangepoint package does is it combines a few functions from several changepoint packages together and offers the ggplot2 style changepoint plots.</p>
<p>In this introduction, all the data sets used are the same as <span class="citation">Killick and Eckley (2014)</span> starting from the Section 4.1, and all the variables are defined the same as the reference. Instead of following the authors’ code, we use ggchangepoint to carry out all the analysis, and users can make reasonable comparisons.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://pursuitofdatascience.github.io/ggchangepoint/">ggchangepoint</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme_get.html" class="external-link">theme_set</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_light</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="section level3">
<h3 id="changes-in-mean">Changes in mean<a class="anchor" aria-label="anchor" href="#changes-in-mean"></a>
</h3>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span>
<span class="va">m.data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, 
            <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, 
            <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,
            <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">0.2</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>Using <code>PELT</code> as the changepoint method:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">m.pelt</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cpt_wrapper.html">cpt_wrapper</a></span><span class="op">(</span><span class="va">m.data</span>, change_in <span class="op">=</span> <span class="st">"mean"</span>, cp_method <span class="op">=</span> <span class="st">"PELT"</span><span class="op">)</span>

<span class="va">m.pelt</span> 
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 2</span></span>
<span class="co">#&gt;      cp cp_value</span>
<span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">1</span>    97    -<span style="color: #BB0000;">1.61</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">2</span>   192     2.00</span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/ggcptplot.html">ggcptplot</a></span><span class="op">(</span><span class="va">m.data</span>, change_in <span class="op">=</span> <span class="st">"mean"</span>, cp_method <span class="op">=</span> <span class="st">"PELT"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Changes in mean (PELT)"</span><span class="op">)</span></code></pre></div>
<p><img src="introduction_files/figure-html/unnamed-chunk-4-1.png" width="768"></p>
<p>Using <code>BinSeg</code> as the changepoint method:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">m.binseg</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cpt_wrapper.html">cpt_wrapper</a></span><span class="op">(</span><span class="va">m.data</span>, change_in <span class="op">=</span> <span class="st">"mean"</span>, cp_method <span class="op">=</span> <span class="st">"BinSeg"</span><span class="op">)</span>

<span class="va">m.binseg</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 2</span></span>
<span class="co">#&gt;      cp cp_value</span>
<span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">1</span>    79    -<span style="color: #BB0000;">1.05</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">2</span>   192     2.00</span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/ggcptplot.html">ggcptplot</a></span><span class="op">(</span><span class="va">m.data</span>, change_in <span class="op">=</span> <span class="st">"mean"</span>, cp_method <span class="op">=</span> <span class="st">"BinSeg"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Changes in mean (BinSeg)"</span><span class="op">)</span></code></pre></div>
<p><img src="introduction_files/figure-html/unnamed-chunk-6-1.png" width="768"></p>
<p><code>PELT</code> with <code>penalty = "Manual"</code>:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">m.pm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cpt_wrapper.html">cpt_wrapper</a></span><span class="op">(</span><span class="va">m.data</span>, 
                    change_in <span class="op">=</span> <span class="st">"mean"</span>, 
                    penalty <span class="op">=</span> <span class="st">"Manual"</span>, 
                    pen.value <span class="op">=</span> <span class="st">"1.5 * log(n)"</span><span class="op">)</span>

<span class="va">m.pm</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 × 2</span></span>
<span class="co">#&gt;      cp cp_value</span>
<span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">1</span>    97   -<span style="color: #BB0000;">1.61</span> </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">2</span>   192    2.00 </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">3</span>   273   -<span style="color: #BB0000;">0.481</span></span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/ggcptplot.html">ggcptplot</a></span><span class="op">(</span><span class="va">m.data</span>, 
          change_in <span class="op">=</span> <span class="st">"mean"</span>, 
          penalty <span class="op">=</span> <span class="st">"Manual"</span>, 
          pen.value <span class="op">=</span> <span class="st">"1.5 * log(n)"</span>,
          cptline_color <span class="op">=</span> <span class="st">"red"</span>,
          cptline_size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Changes in mean (PELT with Manual penalty)"</span><span class="op">)</span></code></pre></div>
<p><img src="introduction_files/figure-html/unnamed-chunk-8-1.png" width="768"></p>
<p><code>BinSeg</code> with <code>penalty = "Manual"</code>:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">m.bsm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cpt_wrapper.html">cpt_wrapper</a></span><span class="op">(</span><span class="va">m.data</span>, 
                     change_in <span class="op">=</span> <span class="st">"mean"</span>, 
                     cp_method <span class="op">=</span> <span class="st">"BinSeg"</span>,
                     penalty <span class="op">=</span> <span class="st">"Manual"</span>, 
                     pen.value <span class="op">=</span> <span class="st">"1.5 * log(n)"</span><span class="op">)</span>

<span class="va">m.bsm</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 4 × 2</span></span>
<span class="co">#&gt;      cp cp_value</span>
<span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">1</span>    79   -<span style="color: #BB0000;">1.05</span> </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">2</span>    99    0.148</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">3</span>   192    2.00 </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">4</span>   273   -<span style="color: #BB0000;">0.481</span></span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/ggcptplot.html">ggcptplot</a></span><span class="op">(</span><span class="va">m.data</span>, 
          change_in <span class="op">=</span> <span class="st">"mean"</span>, 
          cp_method <span class="op">=</span> <span class="st">"BinSeg"</span>,
          penalty <span class="op">=</span> <span class="st">"Manual"</span>, 
          pen.value <span class="op">=</span> <span class="st">"1.5 * log(n)"</span>,
          cptline_size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Changes in mean (BinSeg with Manual penalty)"</span><span class="op">)</span></code></pre></div>
<p><img src="introduction_files/figure-html/unnamed-chunk-10-1.png" width="768"></p>
<p>Since <span class="citation">Killick and Eckley (2014)</span> used a data set from <span class="citation">Lai et al. (2005)</span> about genomic hy- bridization (aCGH). Here we also use the data set:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"Lai2005fig4"</span>, package <span class="op">=</span> <span class="st">"changepoint"</span><span class="op">)</span>

<span class="fu"><a href="../reference/cpt_wrapper.html">cpt_wrapper</a></span><span class="op">(</span><span class="va">Lai2005fig4</span><span class="op">$</span><span class="va">GBM29</span>, change_in <span class="op">=</span> <span class="st">"mean"</span><span class="op">)</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 2</span></span>
<span class="co">#&gt;      cp cp_value</span>
<span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">1</span>    81   0.033<span style="text-decoration: underline;">0</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">2</span>    85   4.72  </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">3</span>    89   0.299 </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">4</span>    96   3.99  </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">5</span>   123   1.23  </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">6</span>   133   4.47</span></code></pre></div>
<p>And we can quickly visualize it:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/ggcptplot.html">ggcptplot</a></span><span class="op">(</span><span class="va">Lai2005fig4</span><span class="op">$</span><span class="va">GBM29</span>, change_in <span class="op">=</span> <span class="st">"mean"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"GBM29 Changes in mean (PELT)"</span><span class="op">)</span></code></pre></div>
<p><img src="introduction_files/figure-html/unnamed-chunk-12-1.png" width="768"></p>
<p>We can also use <code><a href="../reference/ecp_wrapper.html">ecp_wrapper()</a></code> to carry out the similar task on the data:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">2022</span><span class="op">)</span>
<span class="fu"><a href="../reference/ecp_wrapper.html">ecp_wrapper</a></span><span class="op">(</span><span class="va">Lai2005fig4</span><span class="op">$</span><span class="va">GBM29</span><span class="op">)</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 8 × 2</span></span>
<span class="co">#&gt;      cp cp_value</span>
<span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">1</span>    29   1.31  </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">2</span>    33   0.728 </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">3</span>    82   4.51  </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">4</span>    86   0.718 </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">5</span>    90   5.62  </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">6</span>    97   0.698 </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">7</span>   124   4.59  </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">8</span>   134   0.030<span style="text-decoration: underline;">2</span></span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">2022</span><span class="op">)</span>
<span class="fu"><a href="../reference/ggecpplot.html">ggecpplot</a></span><span class="op">(</span><span class="va">Lai2005fig4</span><span class="op">$</span><span class="va">GBM29</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"GBM29 Changes using the ecp package"</span><span class="op">)</span></code></pre></div>
<p><img src="introduction_files/figure-html/unnamed-chunk-14-1.png" width="768"></p>
<p>We can use <code><a href="../reference/ggcptplot.html">ggcptplot()</a></code> to detect and visualize changepoints detected by various functions. Otherwise, various packages need to be used.</p>
</div>
<div class="section level3">
<h3 id="changes-in-variance">Changes in variance<a class="anchor" aria-label="anchor" href="#changes-in-variance"></a>
</h3>
<p><span class="citation">Killick and Eckley (2014)</span> referenced the Irish wind speeds data set, which has previously been analyzed by <span class="citation">Haslett and Raftery (1989)</span> and <span class="citation">Gneiting, Genton, and Guttorp (2006)</span>. It is a data set from the gstat package.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"wind"</span>, package <span class="op">=</span> <span class="st">"gstat"</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">wind.bs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cpt_wrapper.html">cpt_wrapper</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diff.html" class="external-link">diff</a></span><span class="op">(</span><span class="va">wind</span><span class="op">[</span>, <span class="fl">11</span><span class="op">]</span><span class="op">)</span>, change_in <span class="op">=</span> <span class="st">"var"</span>, cp_method <span class="op">=</span> <span class="st">"BinSeg"</span><span class="op">)</span>

<span class="va">wind.bs</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 × 2</span></span>
<span class="co">#&gt;      cp cp_value</span>
<span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">1</span>  <span style="text-decoration: underline;">2</span>971     13.2</span></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/ggcptplot.html">ggcptplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diff.html" class="external-link">diff</a></span><span class="op">(</span><span class="va">wind</span><span class="op">[</span>, <span class="fl">11</span><span class="op">]</span><span class="op">)</span>, change_in <span class="op">=</span> <span class="st">"var"</span>, cp_method <span class="op">=</span> <span class="st">"BinSeg"</span><span class="op">)</span></code></pre></div>
<p><img src="introduction_files/figure-html/unnamed-chunk-17-1.png" width="768"></p>
<p>There is only one changepoint detected in the data.</p>
</div>
<div class="section level3">
<h3 id="changes-in-mean-and-variance">Changes in mean and variance<a class="anchor" aria-label="anchor" href="#changes-in-mean-and-variance"></a>
</h3>
<p>Since <code>cpt.meanvar()</code> is the default setting of <code><a href="../reference/cpt_wrapper.html">cpt_wrapper()</a></code>. There will be no extra specification in the <code>change_in</code> argument.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"discoveries"</span>, package <span class="op">=</span> <span class="st">"datasets"</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dis.pelt</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cpt_wrapper.html">cpt_wrapper</a></span><span class="op">(</span><span class="va">discoveries</span>, test.stat <span class="op">=</span> <span class="st">"Poisson"</span><span class="op">)</span>

<span class="va">dis.pelt</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 × 2</span></span>
<span class="co">#&gt;      cp cp_value</span>
<span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">1</span>    24        3</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">2</span>    29        9</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">3</span>    73        3</span></code></pre></div>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/ggcptplot.html">ggcptplot</a></span><span class="op">(</span><span class="va">discoveries</span>, test.stat <span class="op">=</span> <span class="st">"Poisson"</span>,
          cptline_color <span class="op">=</span> <span class="st">"red"</span>,
          cptline_size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"The Discoveries dataset with identified changepoints (PELT)"</span><span class="op">)</span></code></pre></div>
<p><img src="introduction_files/figure-html/unnamed-chunk-20-1.png" width="768"></p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/ggcptplot.html">ggcptplot</a></span><span class="op">(</span><span class="va">discoveries</span>, test.stat <span class="op">=</span> <span class="st">"Poisson"</span>,
          cp_method <span class="op">=</span> <span class="st">"BinSeg"</span>,
          cptline_color <span class="op">=</span> <span class="st">"red"</span>,
          cptline_size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"The Discoveries dataset with identified changepoints (BinSeg)"</span><span class="op">)</span></code></pre></div>
<p><img src="introduction_files/figure-html/unnamed-chunk-21-1.png" width="768"></p>
</div>
<div class="section level3 unnumbered">
<h3 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h3>
<div id="refs" class="references">
<div id="ref-gneiting2006geostatistical">
<p>Gneiting, Tilmann, Marc G Genton, and Peter Guttorp. 2006. “Geostatistical Space-Time Models, Stationarity, Separability, and Full Symmetry.” <em>Monographs on Statistics and Applied Probability</em> 107: 151.</p>
</div>
<div id="ref-haslett1989space">
<p>Haslett, John, and Adrian E Raftery. 1989. “Space-Time Modelling with Long-Memory Dependence: Assessing Ireland’s Wind Power Resource.” <em>Journal of the Royal Statistical Society: Series C (Applied Statistics)</em> 38 (1): 1–21.</p>
</div>
<div id="ref-killick2014changepoint">
<p>Killick, Rebecca, and Idris Eckley. 2014. “Changepoint: An R Package for Changepoint Analysis.” <em>Journal of Statistical Software</em> 58 (3): 1–19.</p>
</div>
<div id="ref-lai2005comparative">
<p>Lai, Weil R, Mark D Johnson, Raju Kucherlapati, and Peter J Park. 2005. “Comparative Analysis of Algorithms for Identifying Amplifications and Deletions in Array Cgh Data.” <em>Bioinformatics</em> 21 (19): 3763–70.</p>
</div>
</div>
</div>
  </main>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Crafted by <a href="https://youzhi.netlify.app/" class="external-link">Youzhi Yu</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
